
var pin_images=mapfunctions_vars.pin_images;var images=jQuery.parseJSON(pin_images);var ipad_time=0;var infobox_id=0;var shape={coord:[1,1,1,38,38,59,59,1],type:"poly"};var mcOptions;var mcluster;var clusterStyles;var pin_hover_storage;var first_time_wpestate_show_inpage_ajax_half=0;var panorama;var infoBox_sh=null;var poi_marker_array=[];var poi_type="";var placeCircle="";var initialGeop=0;function wpestate_agency_map_function(){var f=jQuery("#agency_map").attr("data-cur_lat");var c=jQuery("#agency_map").attr("data-cur_long");var b={flat:false,noClear:false,zoom:5,scrollwheel:false,draggable:true,center:new google.maps.LatLng(f,c),streetViewControl:false,disableDefaultUI:true,mapTypeId:mapfunctions_vars.type.toLowerCase(),gestureHandling:"cooperative"};map_agency=new google.maps.Map(document.getElementById("agency_map"),b);if(mapfunctions_vars.map_style!==""){var d=JSON.parse(mapfunctions_vars.map_style);map_agency.setOptions({styles:d})}google.maps.visualRefresh=true;google.maps.event.trigger(map_agency,"resize");var e=new google.maps.LatLng(f,c);var a=new google.maps.Marker({position:e,map:map_agency,icon:wpesate_custompin_agency(),shape:shape,title:"we are here",zIndex:1,infoWindowIndex:0})}function wpesate_custompin_agency(){var a={url:mapfunctions_vars.path+"/sale.png",size:new google.maps.Size(59,59),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,59)};return a}function wpestate_map_shortcode_function(){var m=parseInt(jQuery("#googleMap_shortcode").attr("data-post_id"),10);var q=jQuery("#googleMap_shortcode").attr("data-cur_lat");var x=jQuery("#googleMap_shortcode").attr("data-cur_long");var c;var G;var D=[];if(typeof googlecode_property_vars==="undefined"){c=5;heading=0}else{c=googlecode_property_vars.page_custom_zoom;heading=parseInt(googlecode_property_vars.camera_angle)}var o={flat:false,noClear:false,zoom:parseInt(c),scrollwheel:false,draggable:true,center:new google.maps.LatLng(q,x),streetViewControl:false,disableDefaultUI:true,mapTypeId:mapfunctions_vars.type.toLowerCase(),gestureHandling:"cooperative"};G=new google.maps.Map(document.getElementById("googleMap_shortcode"),o);google.maps.visualRefresh=true;google.maps.event.trigger(G,"resize");width_browser=jQuery(window).width();infobox_width=700;vertical_pan=-215;if(width_browser<900){infobox_width=500}if(width_browser<600){infobox_width=400}if(width_browser<400){infobox_width=200}var r=document.createElement("div");var v={content:r,disableAutoPan:true,maxWidth:infobox_width,boxClass:"mybox",zIndex:null,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:true};infoBox_sh=new InfoBox(v);if(mapfunctions_vars.map_style!==""){var j=JSON.parse(mapfunctions_vars.map_style);G.setOptions({styles:j})}var B=1;var w=m;var d=q;var I=x;var H=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-title"));var g=jQuery("#googleMap_shortcode").attr("data-pin");var k=1;var u=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-thumb"));var z=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-price"));var h=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-type"));var t=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-action"));var f=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-prop_url"));var A="";var C="";var F=jQuery("#googleMap_shortcode").attr("data-rooms");var b=jQuery("#googleMap_shortcode").attr("data-bathrooms");var s=jQuery("#googleMap_shortcode").attr("data-size");var p=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-type"));var y=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-single-first-action"));var n="";var a="";var E=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-pin_price"));var e=decodeURIComponent(jQuery("#googleMap_shortcode").attr("data-clean_price"));createMarker_sh(E,infoBox_sh,D,G,a,s,B,w,d,I,g,H,k,u,z,h,t,f,A,C,F,b,e,p,y);var l=new google.maps.LatLng(q,x);panorama=G.getStreetView();panorama.setPosition(l);panorama.setPov(({heading:heading,pitch:0}));jQuery("#slider_enable_street_sh").click(function(){cur_lat=jQuery("#googleMap_shortcode").attr("data-cur_lat");cur_long=jQuery("#googleMap_shortcode").attr("data-cur_long");myLatLng=new google.maps.LatLng(cur_lat,cur_long);panorama.setPosition(myLatLng);panorama.setVisible(true);jQuery("#gmapzoomminus_sh,#gmapzoomplus_sh,#slider_enable_street_sh").hide()});google.maps.event.addListener(panorama,"closeclick",function(){jQuery("#gmapzoomminus_sh,#gmapzoomplus_sh,#slider_enable_street_sh").show()});if(document.getElementById("gmapzoomplus_sh")){google.maps.event.addDomListener(document.getElementById("gmapzoomplus_sh"),"click",function(){var i=parseInt(G.getZoom(),10);i++;if(i>20){i=20}G.setZoom(i)})}if(document.getElementById("gmapzoomminus_sh")){google.maps.event.addDomListener(document.getElementById("gmapzoomminus_sh"),"click",function(){var i=parseInt(G.getZoom(),10);i--;if(i<0){i=0}G.setZoom(i)})}google.maps.event.trigger(D[0],"click");setTimeout(function(){google.maps.event.trigger(G,"resize");G.setCenter(D[0].position);switch(infobox_width){case 700:G.panBy(100,-150);vertical_off=0;break;case 500:G.panBy(50,-120);break;case 400:G.panBy(100,-220);break;case 200:G.panBy(20,-170);break}},300);wpestate_initialize_poi(G,2)}function createMarker_sh(J,h,E,q,o,e,K,F,B,u,y,z,a,b,A,x,f,d,m,C,H,p,c,r,w){var G="";var l=new google.maps.LatLng(B,u);var n=0;var s=" price_infobox ";if(mapfunctions_vars.useprice==="yes"){var l=new google.maps.LatLng(B,u);var v=jQuery("<textarea />").html(z).text();var D=new google.maps.LatLng(B,u);var k=999;var n=11;var I=A;var j=parseFloat(getCookie_map("my_custom_curr_pos"));if(!isNaN(j)&&j!==-1){var g=wpestate_get_price_currency(c,c);var t=A.match("</span>(.*)<span class=");if(t!==null){var I=A.replace(t[1],g)}}L=new WpstateMarker(n,D,q,v,a,b,F,I,J,x,f,d,K,H,p,c,e,r,w,y,k)}else{s=" classic_info ";var L=new google.maps.Marker({position:l,map:q,icon:custompin(y),shape:shape,title:z,zIndex:a,image:b,idul:F,price:A,category:x,action:f,link:d,city:m,area:C,infoWindowIndex:K,rooms:H,baths:p,cleanprice:c,size:e,county_state:o,category_name:r,action_name:w})}E.push(L);google.maps.event.addListener(L,"click",function(M){if(this.image===""){info_image='<img src="'+mapfunctions_vars.path+'/idxdefault.jpg" alt="image" />'}else{info_image=this.image}var N=decodeURIComponent(this.category.replace(/-/g," "));var Q=decodeURIComponent(this.action.replace(/-/g," "));var P=decodeURIComponent(this.category_name.replace(/-/g," "));var R=decodeURIComponent(this.action_name.replace(/-/g," "));var i=mapfunctions_vars.in_text;if(N===""||Q===""){i=" "}var O;if(this.baths!=""){O='<span id="infobath">'+this.baths+"</span>"}else{O=""}var S;if(this.rooms!=""){S='<span id="inforoom">'+this.rooms+"</span>"}else{S=""}var T;if(this.size!=""){T='<span id="infosize">'+this.size;T=T+"</span>"}else{T=""}var U=this.title.substr(0,45);if(this.title.length>45){U=U+"..."}h.setContent('<div class="info_details '+s+'"><span id="infocloser" onClick=\'javascript:infoBox_sh.close();\' ></span><a href="'+this.link+'">'+info_image+'</a><a href="'+this.link+'" id="infobox_title">'+U+'</a><div class="prop_detailsx">'+P+" "+i+" "+R+'</div><div class="prop_pricex">'+wpestate_get_price_currency(this.price,this.cleanprice)+T+O+S+"</div></div>");h.open(q,this);q.setCenter(this.position);if(control_vars.show_adv_search_map_close==="no"){$(".search_wrapper").addClass("adv1_close");adv_search_click()}close_adv_search()})}function wpestate_change_map_type(a){if(a==="map-view-roadmap"){map.setMapTypeId(google.maps.MapTypeId.ROADMAP)}else{if(a==="map-view-satellite"){map.setMapTypeId(google.maps.MapTypeId.SATELLITE)}else{if(a==="map-view-hybrid"){map.setMapTypeId(google.maps.MapTypeId.HYBRID)}else{if(a==="map-view-terrain"){map.setMapTypeId(google.maps.MapTypeId.TERRAIN)}}}}}function setMarkers(C,B,o){var c;var y;var m=parseInt(jQuery("#gmap_wrapper").attr("data-post_id"));if(isNaN(m)){m=parseInt(jQuery("#googleMapSlider").attr("data-post_id"),10)}var d=parseInt(mapfunctions_vars.open_height,10);var l=parseInt(mapfunctions_vars.closed_height,10);var p=document.createElement("div");width_browser=jQuery(window).width();infobox_width=700;vertical_pan=-215;if(width_browser<900){infobox_width=500}if(width_browser<600){infobox_width=400}if(width_browser<400){infobox_width=200}var t={content:p,disableAutoPan:true,maxWidth:infobox_width,boxClass:"mybox",zIndex:null,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:false,pane:"floatPane",enableEventPropagation:true};infoBox=new InfoBox(t);bounds=new google.maps.LatLngBounds();for(var z=0;z<B.length;z++){var v=B[z];var u=v[10];var e=v[1];var E=v[2];var D=decodeURIComponent(v[0]);var h=v[8];var k=v[3];var s=decodeURIComponent(v[4]);var x=decodeURIComponent(v[5]);var j=decodeURIComponent(v[6]);var r=decodeURIComponent(v[7]);var g=decodeURIComponent(v[9]);var f=v[11];var A=v[12];var b=v[13];var q=v[14];var n=decodeURIComponent(v[15]);var w=decodeURIComponent(v[16]);var a=decodeURIComponent(v[17]);createMarker(a,q,z,u,e,E,h,D,k,s,x,j,r,g,A,b,f,n,w);if(m===u){found_id=z}}map_cluster();if(!jQuery("body").hasClass("single-estate_property")){oms=new OverlappingMarkerSpiderfier(C,{markersWontMove:true,markersWontHide:true,keepSpiderfied:true,legWeight:2});setOms(gmarkers)}if(o===1){if(!bounds.isEmpty()){wpestate_fit_bounds(bounds)}else{wpestate_fit_bounds_nolsit()}}if(mapfunctions_vars.generated_pins!=="0"){y=new google.maps.LatLng(e,E)}}function createMarker(a,q,x,t,d,D,j,C,n,s,w,l,r,g,B,b,h,p,v){var u=new google.maps.LatLng(d,D);var A=jQuery("<textarea />").html(C).text();var y=0;var o=" price_infobox ";if(mapfunctions_vars.useprice==="yes"){var z=w;var c=parseFloat(getCookie_map("my_custom_curr_pos"));if(!isNaN(c)&&c!==-1){var k=wpestate_get_price_currency(h,h);var e=w.match("</span>(.*)<span class=");if(e!==null){var z=w.replace(e[1],k)}}var m=new google.maps.LatLng(d,D);f=new WpstateMarker(y,m,map,A,n,s,t,z,a,l,r,g,x,B,b,h,q,p,v,j,x)}else{o=" classic_info ";var f=new google.maps.Marker({position:u,map:map,icon:custompin(j),shape:shape,title:A,zIndex:n,image:s,idul:t,price:w,category:l,action:r,link:g,infoWindowIndex:x,rooms:B,baths:b,cleanprice:h,size:q,category_name:p,action_name:v})}gmarkers.push(f);bounds.extend(f.getPosition());google.maps.event.addListener(f,"click",function(E){map_callback(new_open_close_map);google.maps.event.trigger(map,"resize");if(this.image===""){info_image='<img src="'+mapfunctions_vars.path+'/idxdefault.jpg" alt="image" />'}else{info_image=this.image}var F=decodeURIComponent(this.category.replace(/-/g," "));var I=decodeURIComponent(this.action.replace(/-/g," "));var H=decodeURIComponent(this.category_name.replace(/-/g," "));var J=decodeURIComponent(this.action_name.replace(/-/g," "));var i=mapfunctions_vars.in_text;if(F===""||I===""){i=" "}var G;if(this.baths!=""){G='<span id="infobath">'+this.baths+"</span>"}else{G=""}var K;if(this.rooms!=""){K='<span id="inforoom">'+this.rooms+"</span>"}else{K=""}var L;if(this.size!=""){L='<span id="infosize">'+this.size;L=L+"</span>"}else{L=""}var M=this.title.substr(0,45);if(this.title.length>45){M=M+"..."}infoBox.setContent('<div class="info_details '+o+'"><span id="infocloser" onClick=\'javascript:infoBox.close();\' ></span><a href="'+this.link+'">'+info_image+'</a><a href="'+this.link+'" id="infobox_title">'+M+'</a><div class="prop_detailsx">'+H+" "+i+" "+J+'</div><div class="prop_pricex">'+wpestate_get_price_currency(this.price,this.cleanprice)+L+G+K+"</div></div>");infoBox.open(map,this);map.setCenter(this.position);switch(infobox_width){case 700:if(mapfunctions_vars.listing_map==="top"){map.panBy(100,-150)}else{if(mapfunctions_vars.small_slider_t==="vertical"){map.panBy(300,-300)}else{map.panBy(10,-110)}}vertical_off=0;break;case 500:map.panBy(50,-120);break;case 400:map.panBy(20,-150);break;case 200:map.panBy(20,-170);break}if(control_vars.show_adv_search_map_close==="no"){$(".search_wrapper").addClass("adv1_close");adv_search_click()}close_adv_search()})}function pan_to_last_pin(a){map.setCenter(a)}function setOms(a){for(var b=0;b<a.length;b++){if(typeof oms!=="undefined"){oms.addMarker(a[b])}else{}}}function set_google_search(c){var a,d,b;a=(document.getElementById("google-default-search"));d=new google.maps.places.SearchBox(a);google.maps.event.addListener(d,"places_changed",function(){b=d.getPlaces();if(b.length==0){return}var h=new google.maps.LatLngBounds();for(var g=0,f;f=b[g];g++){var j={url:f.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};var e=new google.maps.Marker({map:c,icon:j,title:f.name,position:f.geometry.location});gmarkers.push(e);h.extend(f.geometry.location)}c.fitBounds(h);if(!h.isEmpty()){wpestate_fit_bounds(h)}else{wpestate_fit_bounds_nolsit()}c.setZoom(15)});google.maps.event.addListener(c,"bounds_changed",function(){var e=c.getBounds();d.setBounds(e)})}function wpestate_fit_bounds_nolsit(){map.setZoom(3)}function wpestate_fit_bounds(a){if(placeCircle!=""){map.fitBounds(placeCircle.getBounds())}else{map.fitBounds(a);google.maps.event.addListenerOnce(map,"idle",function(){if(map.getZoom()>15){map.setZoom(15)}})}}function new_open_close_map(c){if(jQuery("#gmap_wrapper").hasClass("fullmap")){return}if(mapfunctions_vars.open_close_status!=="1"){var d=jQuery("#googleMap").outerHeight();var f=parseInt(mapfunctions_vars.closed_height,10);var b=parseInt(mapfunctions_vars.open_height,10);var a=b;var e=b;if(infoBox!==null){infoBox.close()}if(d===f){a=b;if(Modernizr.mq("only all and (max-width: 940px)")){e=b}else{jQuery("#gmap-menu").show();e=b}new_show_advanced_search();vertical_off=0;jQuery("#openmap").empty().append('<i class="fa fa-angle-up"></i>'+mapfunctions_vars.close_map)}else{if(c===2){jQuery("#gmap-menu").hide();jQuery("#advanced_search_map_form").hide();a=e=f;new_hide_advanced_search();vertical_off=150}}jQuery("#gmap_wrapper").css("height",e+"px");jQuery("#googleMap").css("height",a+"px");jQuery(".tooltip").fadeOut("fast");setTimeout(function(){google.maps.event.trigger(map,"resize")},300)}}function map_cluster(){if(mapfunctions_vars.user_cluster==="yes"){clusterStyles=[{textColor:"#ffffff",opt_textColor:"#ffffff",url:mapfunctions_vars.path+"/cloud.png",height:72,width:72,textSize:15,}];mcOptions={gridSize:50,ignoreHidden:true,maxZoom:parseInt(mapfunctions_vars.zoom_cluster,10),styles:clusterStyles};mcluster=new MarkerClusterer(map,gmarkers,mcOptions);mcluster.setIgnoreHidden(true)}}if(document.getElementById("gmapzoomplus")){google.maps.event.addDomListener(document.getElementById("gmapzoomplus"),"click",function(){var a=parseInt(map.getZoom(),10);a++;if(a>20){a=20}map.setZoom(a)})}if(document.getElementById("gmapzoomminus")){google.maps.event.addDomListener(document.getElementById("gmapzoomminus"),"click",function(){var a=parseInt(map.getZoom(),10);a--;if(a<0){a=0}map.setZoom(a)})}if(document.getElementById("geolocation-button")){google.maps.event.addDomListener(document.getElementById("geolocation-button"),"click",function(){myposition(map);close_adv_search()})}if(document.getElementById("mobile-geolocation-button")){google.maps.event.addDomListener(document.getElementById("mobile-geolocation-button"),"click",function(){myposition(map);close_adv_search()})}function myposition(b){if(navigator.geolocation){var a;if(location.protocol==="https:"){navigator.geolocation.getCurrentPosition(showMyPosition_original,errorCallback,{timeout:10000})}else{jQuery.getJSON("http://ipinfo.io",function(c){a=c.loc.split(",");showMyPosition(a)})}}else{alert(mapfunctions_vars.geo_no_brow)}}function errorCallback(){alert(mapfunctions_vars.geo_no_pos)}function showMyPosition_original(g){var b={coord:[1,1,1,38,38,59,59,1],type:"poly"};var f=new google.maps.LatLng(g.coords.latitude,g.coords.longitude);map.setCenter(f);var a=new google.maps.Marker({position:f,map:map,icon:custompinchild(),shape:b,title:"",zIndex:999999999,image:"",price:"",category:"",action:"",link:"",infoWindowIndex:99,radius:parseInt(mapfunctions_vars.geolocation_radius,10)+" "+mapfunctions_vars.geo_message});var d={strokeColor:"#67cfd8",strokeOpacity:0.6,strokeWeight:1,fillColor:"#67cfd8",fillOpacity:0.2,map:map,center:f,radius:parseInt(mapfunctions_vars.geolocation_radius,10)};var e=new google.maps.Circle(d);var c=new Label({map:map});c.bindTo("position",a);c.bindTo("text",a,"radius");c.bindTo("visible",a);c.bindTo("clickable",a);c.bindTo("zIndex",a)}var geo_markers=[];var geo_circle=[];var geo_label=[];function showMyPosition(h){for(var e=0;e<geo_markers.length;e++){geo_markers[e].setMap(null);geo_circle[e].setMap(null);geo_label[e].setMap(null)}geo_markers=[];geo_circle=[];geo_label=[];var b={coord:[1,1,1,38,38,59,59,1],type:"poly"};var g=new google.maps.LatLng(h[0],h[1]);map.setCenter(g);map.setZoom(13);var a=new google.maps.Marker({position:g,map:map,icon:custompinchild(),shape:b,title:"",zIndex:999999999,image:"",price:"",category:"",action:"",link:"",infoWindowIndex:99,radius:parseInt(mapfunctions_vars.geolocation_radius,10)+" "+mapfunctions_vars.geo_message});geo_markers.push(a);var d={strokeColor:"#67cfd8",strokeOpacity:0.6,strokeWeight:1,fillColor:"#67cfd8",fillOpacity:0.2,map:map,center:g,radius:parseInt(mapfunctions_vars.geolocation_radius,10)};var f=new google.maps.Circle(d);geo_circle.push(f);var c=new Label({map:map});c.bindTo("position",a);c.bindTo("text",a,"radius");c.bindTo("visible",a);c.bindTo("clickable",a);c.bindTo("zIndex",a);geo_label.push(f)}function custompinchild(){var c;var d="";var a=jQuery(window).dense("devicePixelRatio");if(a>1){d="_2x"}if(typeof(images.userpin)==="undefined"||images.userpin===""){c=mapfunctions_vars.path+"/userpin"+d+".png"}else{c=images.userpin;if(a>1){c=c.replace(".png","_2x.png")}}if(a>1){var b={url:c,size:new google.maps.Size(88,96),scaledSize:new google.maps.Size(44,48),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,59)}}else{var b={url:c,size:new google.maps.Size(59,59),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,59)}}return b}if(document.getElementById("gmap")){google.maps.event.addDomListener(document.getElementById("gmap"),"mouseout",function(){google.maps.event.trigger(map,"resize")})}if(document.getElementById("search_map_button")){google.maps.event.addDomListener(document.getElementById("search_map_button"),"click",function(){infoBox.close()})}if(document.getElementById("advanced_search_map_button")){google.maps.event.addDomListener(document.getElementById("advanced_search_map_button"),"click",function(){infoBox.close()})}jQuery("#gmap-next").click(function(){current_place++;if(current_place>gmarkers.length){current_place=1}while(gmarkers[current_place-1].visible===false){current_place++;if(current_place>gmarkers.length){current_place=1}}if(map.getZoom()<15){map.setZoom(15)}google.maps.event.trigger(gmarkers[current_place-1],"click")});jQuery("#gmap-prev").click(function(){current_place--;if(current_place<1){current_place=gmarkers.length}while(gmarkers[current_place-1].visible===false){current_place--;if(current_place>gmarkers.length){current_place=1}}if(map.getZoom()<15){map.setZoom(15)}google.maps.event.trigger(gmarkers[current_place-1],"click")});jQuery(".advanced_action_div li").click(function(){var a=jQuery(this).val()});if(document.getElementById("gmap-menu")){google.maps.event.addDomListener(document.getElementById("gmap-menu"),"click",function(a){infoBox.close();if(a.target.nodeName==="INPUT"){category=a.target.className;if(a.target.name==="filter_action[]"){if(actions.indexOf(category)!==-1){actions.splice(actions.indexOf(category),1)}else{actions.push(category)}}if(a.target.name==="filter_type[]"){if(categories.indexOf(category)!==-1){categories.splice(categories.indexOf(category),1)}else{categories.push(category)}}show(actions,categories)}})}function getCookieMap(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function get_custom_value_tab_search(a){var c="";var b=0;if(a==="adv_categ"||a==="adv_actions"||a==="advanced_city"||a==="advanced_area"||a==="county-state"){c=jQuery(".tab-pane.active #"+a).attr("data-value")}else{if(a==="property_price"&&mapfunctions_vars.slider_price==="yes"){c=jQuery(".tab-pane.active #price_low").val()}else{if(a==="property-country"){c=jQuery(".tab-pane.active #advanced_country").attr("data-value")}else{if(a!==""){if(jQuery(".tab-pane.active #"+a).hasClass("filter_menu_trigger")){c=jQuery(".tab-pane.active #"+a).attr("data-value");b=1}else{c=jQuery(".tab-pane.active #"+a).val()}}}}}return c}function get_custom_value(a){var c;var b=0;if(a==="adv_categ"||a==="adv_actions"||a==="advanced_city"||a==="advanced_area"||a==="county-state"){c=jQuery("#"+a).attr("data-value")}else{if(a==="property_price"&&mapfunctions_vars.slider_price==="yes"){c=jQuery("#price_low").val()}else{if(a==="property-country"){c=jQuery("#advanced_country").attr("data-value")}else{if(jQuery("#"+a).hasClass("filter_menu_trigger")){c=jQuery("#"+a).attr("data-value");b=1}else{c=jQuery("#"+a).val()}}}}if(typeof(c)!=="undefined"&&b===0){}return c}function get_custom_value_onthelist(a){var c;var b=0;if(a==="adv_categ"||a==="adv_actions"||a==="advanced_city"||a==="advanced_area"||a==="county-state"){c=jQuery("#"+a).attr("data-value");if(a==="adv_categ"){c=jQuery("#tax_categ_picked").val()}else{if(a==="adv_actions"){c=jQuery("#tax_action_picked").val()}else{if(a==="advanced_city"){c=jQuery("#tax_city_picked").val()}else{if(a==="advanced_area"){c=jQuery("#taxa_area_picked").val()}}}}}else{if(a==="property_price"&&mapfunctions_vars.slider_price==="yes"){c=jQuery("#price_low").val()}else{if(a==="property-country"){c=jQuery("#advanced_country").attr("data-value")}else{if(jQuery("#"+a).hasClass("filter_menu_trigger")){c=jQuery("#"+a).attr("data-value");b=1}else{c=jQuery("#"+a).val()}}}}return c}function wpestate_show_pins(){console.log("wpestate_show_pins");jQuery("#results").show();jQuery("#results_wrapper").empty().append('<div class="preview_results_loading">'+mapfunctions_vars.loading_results+"</div>").show();var h,b,i,c,g,e,m,l,j,a,f,k,n;if(typeof infoBox!=="undefined"&&infoBox!==null){infoBox.close()}jQuery("#gmap-loading").show();console.log("mapfunctions_vars.adv_search_type "+mapfunctions_vars.adv_search_type);if(typeof(googlecode_regular_vars)!="undefined"){if((mapfunctions_vars.adv_search_type==="8"||mapfunctions_vars.adv_search_type==="9")&&googlecode_regular_vars.is_half_map_list!=="1"){wpestate_show_pins_type2_tabs();return}if(mapfunctions_vars.adv_search_type==="2"&&googlecode_regular_vars.is_half_map_list!=="1"&&googlecode_regular_vars.is_adv_search!=="1"){wpestate_show_pins_type2();return}}else{if((mapfunctions_vars.adv_search_type==="8"||mapfunctions_vars.adv_search_type==="9")){wpestate_show_pins_type2_tabs();return}if(mapfunctions_vars.adv_search_type==="2"&&googlecode_regular_vars.is_half_map_list!=="1"){wpestate_show_pins_type2();return}}if(mapfunctions_vars.custom_search==="yes"){wpestate_show_pins_custom_search();return}h=jQuery("#adv_actions").attr("data-value");b=jQuery("#adv_categ").attr("data-value");i=jQuery("#advanced_city").attr("data-value");c=jQuery("#advanced_area").attr("data-value");g=parseFloat(jQuery("#adv_rooms").val(),10);e=parseFloat(jQuery("#adv_bath").val(),10);m=parseFloat(jQuery("#price_low").val(),10);l=parseFloat(jQuery("#price_max").val(),10);a=parseFloat(jQuery("#adv-search-1").attr("data-postid"),10);j=ajaxcalls_vars.admin_url+"admin-ajax.php";if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}k="";jQuery('.extended_search_check_wrapper  input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){k=k+","+jQuery(this).attr("name")}});f=0;n=0;if(jQuery("#google_map_prop_list_sidebar").length){f=1}a=1;if(document.getElementById("search_wrapper")){a=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}var p="";var d="";var o="";if(jQuery("#geolocation_search").length>0){p=jQuery("#geolocation_lat").val();d=jQuery("#geolocation_long").val();o=jQuery("#geolocation_radius").val()}jQuery.ajax({type:"POST",url:j,dataType:"json",data:{action:"wpestate_classic_ondemand_pin_load",action_values:h,category_values:b,city:i,area:c,advanced_rooms:g,advanced_bath:e,price_low:m,price_max:l,newpage:n,postid:a,halfmap:f,all_checkers:k,geo_lat:p,geo_long:d,geo_rad:o},success:function(r){var q=parseInt(r.no_results);if(q!==0){wpestate_load_on_demand_pins(r.markers,q,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(q){}})}function wpestate_show_pins_type2(){console.log("wpestate_show_pins_type2");var b,a,h,g,f,e,d,c;b=jQuery("#adv_actions").attr("data-value");a=jQuery("#adv_categ").attr("data-value");h=jQuery("#adv_location").val();f=parseInt(jQuery("#adv-search-1").attr("data-postid"),10);g=ajaxcalls_vars.admin_url+"admin-ajax.php";e=0;c=0;if(jQuery("#google_map_prop_list_sidebar").length){e=1}f=1;if(document.getElementById("search_wrapper")){f=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}jQuery.ajax({type:"POST",url:g,dataType:"json",data:{action:"wpestate_classic_ondemand_pin_load_type2",action_values:b,category_values:a,location:h},success:function(j){var i=parseInt(j.no_results);if(i!==0){wpestate_load_on_demand_pins(j.markers,i,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(i){}});if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}}function wpestate_show_pins_type2_tabs(){console.log("wpestate_show_pins 2tavs");var e,c,a,f,b,d,h,i,g;e=jQuery(".tab-pane.active #adv_actions").attr("data-value");if(typeof e==="undefined"){e=""}c=jQuery(".tab-pane.active #adv_categ").attr("data-value");if(typeof c==="undefined"){c=""}a=jQuery(".tab-pane.active #adv_location").val();g=jQuery(".tab-pane.active .picked_tax").val();b=parseInt(jQuery("#adv-search-1").attr("data-postid"),10);f=ajaxcalls_vars.admin_url+"admin-ajax.php";d=0;i=0;if(jQuery("#google_map_prop_list_sidebar").length){d=1}b=1;if(document.getElementById("search_wrapper")){b=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}term_id=jQuery(".tab-pane.active .term_id_class").val();h="";jQuery('.tab-pane.active .extended_search_check_wrapper input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){h=h+","+jQuery(this).attr("name")}});jQuery.ajax({type:"POST",url:f,dataType:"json",data:{action:"wpestate_classic_ondemand_pin_load_type2_tabs",action_values:e,category_values:c,location:a,picked_tax:g,all_checkers:h},success:function(k){var j=parseInt(k.no_results);if(j!==0){wpestate_load_on_demand_pins(k.markers,j,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(j){}});if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}}function wpestate_show_pins_custom_search(){console.log("wpestate_show_pins_custom_search ");var q,y,e,u,s,x,w,a,o,h,k,d,l,m;q=ajaxcalls_vars.admin_url+"admin-ajax.php";w=0;y=parseInt(mapfunctions_vars.fields_no,10);s=[];u=[];e=[];u=mapfunctions_vars.slugs;e=mapfunctions_vars.hows;if(mapfunctions_vars.slider_price==="yes"){l=jQuery("#price_low").val();m=jQuery("#price_max").val()}if((mapfunctions_vars.adv_search_type==="6"||mapfunctions_vars.adv_search_type==="7")&&!jQuery(".halfsearch")[0]){o=jQuery(".tab-pane.active .term_id_class").val();if(mapfunctions_vars.slider_price==="yes"){l=jQuery("#price_low_"+o).val();m=jQuery("#price_max_"+o).val()}for(var r=0;r<y;r++){if(e[r]=="date bigger"||e[r]=="date smaller"){a=get_custom_value_tab_search(o+u[r])}else{a=get_custom_value_tab_search(u[r])}if(typeof(a)==="undefined"){a=""}s.push(a)}}else{for(var r=0;r<y;r++){a=get_custom_value(u[r]);if(typeof(a)==="undefined"){a=""}s.push(a)}}if((mapfunctions_vars.adv_search_type==="6"||mapfunctions_vars.adv_search_type==="7"||mapfunctions_vars.adv_search_type==="8"||mapfunctions_vars.adv_search_type==="9")){var n=jQuery(".adv_search_tab_item.active").attr("data-tax");if(jQuery(".halfsearch")[0]){n=jQuery(".halfsearch").attr("data-tax")}if(n==="property_category"){u[y]="adv_categ"}else{if(n==="property_action_category"){u[y]="adv_actions"}else{if(n==="property_city"){u[y]="advanced_city"}else{if(n==="property_area"){u[y]="advanced_area"}else{if(n==="property_county_state"){u[y]="county-state"}}}}}e[y]="like";if(jQuery(".halfsearch")[0]){s[y]=jQuery("#"+u[y]).parent().find("input:hidden").val()}else{s[y]=jQuery(".adv_search_tab_item.active").attr("data-term")}}if(parseInt(mapfunctions_vars.is_half)===1){if(first_time_wpestate_show_inpage_ajax_half===0){first_time_wpestate_show_inpage_ajax_half=1}else{wpestate_show_inpage_ajax_half()}}all_checkers="";jQuery('.search_wrapper .extended_search_check_wrapper  input[type="checkbox"]').each(function(){if(jQuery(this).is(":checked")){all_checkers=all_checkers+","+jQuery(this).attr("name")}});h=0;k=0;if(jQuery("#google_map_prop_list_sidebar").length){h=1}d=1;if(document.getElementById("search_wrapper")){d=parseInt(jQuery("#search_wrapper").attr("data-postid"),10)}var j="";var t="";if(mapfunctions_vars.adv_search_type==="10"){j=jQuery("#adv_actions").attr("data-value");t=jQuery("#adv_location").val()}var g="";var c="";var b="";if(mapfunctions_vars.adv_search_type==="11"){g=jQuery("#adv_actions").attr("data-value");c=jQuery("#adv_categ").attr("data-value");b=jQuery("#keyword_search").val()}var p="";var v="";var f="";if(jQuery("#geolocation_search").length>0){p=jQuery("#geolocation_lat").val();v=jQuery("#geolocation_long").val();f=jQuery("#geolocation_radius").val()}jQuery.ajax({type:"POST",url:q,dataType:"json",data:{action:"wpestate_custom_ondemand_pin_load",search_type:mapfunctions_vars.adv_search_type,val_holder:s,newpage:k,postid:d,halfmap:h,slider_min:l,slider_max:m,all_checkers:all_checkers,filter_search_action10:j,adv_location10:t,filter_search_action11:g,filter_search_categ11:c,keyword_search:b,geo_lat:p,geo_long:v,geo_rad:f},success:function(z){var i=parseInt(z.no_results);if(i!==0){wpestate_load_on_demand_pins(z.markers,i,1)}else{wpestate_show_no_results()}jQuery("#gmap-loading").hide()},error:function(i){}})}function wpestate_empty_map(){if(typeof gmarkers!=="undefined"){for(var a=0;a<gmarkers.length;a++){gmarkers[a].setVisible(false);gmarkers[a].setMap(null)}gmarkers=[];if(typeof(mcluster)!=="undefined"){mcluster.clearMarkers()}}}function wpestate_load_on_demand_pins(e,b,c){console.log("wpestate_load_on_demand_pins");jQuery("#gmap-noresult").hide();wpestate_empty_map();if(document.getElementById("googleMap")){setMarkers(map,e);wpestate_preview_listings(e);if(!bounds.isEmpty()){wpestate_fit_bounds(bounds)}else{wpestate_fit_bounds_nolsit()}}else{wpestate_preview_listings(e)}if(jQuery("#geolocation_search").length>0&&initialGeop===0){var a=jQuery("#geolocation_lat").val();var d=jQuery("#geolocation_long").val();if(a!==""&&d!=""){initialGeop=1;wpestate_geolocation_marker(a,d)}}}function wpestate_preview_listings(h){console.log("wpestate_preview_listings");var a=0;var b="";var f="";var g="";var d="";var e="";var c="";for(var a=0;a<h.length;a++){f=decodeURIComponent(h[a][18]);g=decodeURIComponent(h[a][0]);d=decodeURIComponent(h[a][9]);e=decodeURIComponent(h[a][11]);c=wpestate_get_price_currency(decodeURIComponent(h[a][5]),e);b=b+'<div class="preview_listing_unit" data-href="'+d+'">'+f+" <h4>"+g+'</h4><div class="preview_details">'+c+"</div></div>"}jQuery("#results_wrapper").empty();jQuery("#results_no").show().text(h.length);jQuery("#results_wrapper").append(b);jQuery(".preview_listing_unit").click(function(i){i.preventDefault();var j;j=jQuery(this).attr("data-href");window.open(j,"_self",false)})}function wpestate_get_price_currency(f,g){var b="";var h=decodeURIComponent(getCookie_map("my_custom_curr_symbol"));var d=parseFloat(getCookie_map("my_custom_curr_coef"));var e=parseFloat(getCookie_map("my_custom_curr_pos"));var c=getCookie_map("my_custom_curr_cur_post");var a=0;if(!isNaN(e)&&e!==-1){if(c==="before"){b=h+" "+g*d}else{b=d*g+" "+h}}else{b=f}return b}function getCookie_map(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function wpestate_show_no_results(){jQuery("#results_no").show().text("0");jQuery("#results_wrapper").empty().append('<div class="preview_results_loading">'+mapfunctions_vars.half_no_results+"</div>").show();jQuery("#gmap-noresult").show();if(document.getElementById("google_map_prop_list_wrapper")){jQuery("#listing_ajax_container").empty().append('<p class=" no_results_title ">'+mapfunctions_vars.half_no_results+"</p>")}}function wpestate_show_inpage_ajax_tip2(){console.log("wpestate_show_inpage_ajax_tip2");if(jQuery("#gmap-full").hasClass("spanselected")){jQuery("#gmap-full").trigger("click")}if(mapfunctions_vars.custom_search==="yes"){custom_search_start_filtering_ajax(1)}else{start_filtering_ajax(1)}}function wpestate_show_inpage_ajax_half(){console.log("wpestate_show_inpage_ajax_half");jQuery(".half-pagination").remove();if(mapfunctions_vars.custom_search==="yes"){custom_search_start_filtering_ajax(1)}else{start_filtering_ajax(1)}}function enable_half_map_pin_action(){console.log("enable_half_map_pin_action");jQuery("#google_map_prop_list_sidebar .listing_wrapper").hover(function(){var a=jQuery(this).attr("data-listid");wpestate_hover_action_pin(a)},function(){var a=jQuery(this).attr("data-listid");wpestate_return_hover_action_pin(a)})}function convertToSlug(a){return a.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")}function custompin(b){var d="";var a=jQuery(window).dense("devicePixelRatio");if(a>1){d="_2x"}var c;if(mapfunctions_vars.use_single_image_pin==="no"){if(b!==""){if(typeof(images[b])==="undefined"||images[b]===""){c=mapfunctions_vars.path+"/"+b+d+".png"}else{c=images[b];if(a>1){c=c.replace(".png","_2x.png")}}}else{c=mapfunctions_vars.path+"/none.png"}if(typeof(c)==="undefined"){c=mapfunctions_vars.path+"/none.png"}}else{if(a>1){c=mapfunctions_vars.path+"/single_2x.png"}else{c=mapfunctions_vars.path+"/single.png"}}if(a>1){b={url:c,size:new google.maps.Size(118,118),scaledSize:new google.maps.Size(44,48),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,49),optimized:false}}else{b={url:c,size:new google.maps.Size(59,59),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,49)}}return b}function Label(b){this.setValues(b);var a=this.span_=document.createElement("span");a.style.cssText="position: relative; left: -50%; top: 8px; white-space: nowrap;  padding: 2px; background-color: white;opacity:0.7";var c=this.div_=document.createElement("div");c.appendChild(a);c.style.cssText="position: absolute; display: none"}if(typeof google!=="undefined"){Label.prototype=new google.maps.OverlayView}Label.prototype.onAdd=function(){var b=this.getPanes().overlayImage;b.appendChild(this.div_);var a=this;this.listeners_=[google.maps.event.addListener(this,"position_changed",function(){a.draw()}),google.maps.event.addListener(this,"visible_changed",function(){a.draw()}),google.maps.event.addListener(this,"clickable_changed",function(){a.draw()}),google.maps.event.addListener(this,"text_changed",function(){a.draw()}),google.maps.event.addListener(this,"zindex_changed",function(){a.draw()}),google.maps.event.addDomListener(this.div_,"click",function(){if(a.get("clickable")){google.maps.event.trigger(a,"click")}})]};Label.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);for(var b=0,a=this.listeners_.length;b<a;++b){google.maps.event.removeListener(this.listeners_[b])}};Label.prototype.draw=function(){var c=this.getProjection();var b=c.fromLatLngToDivPixel(this.get("position"));var f=this.div_;f.style.left=b.x+"px";f.style.top=b.y+"px";var d=this.get("visible");f.style.display=d?"block":"none";var a=this.get("clickable");this.span_.style.cursor=a?"pointer":"";var e=this.get("zIndex");f.style.zIndex=e;this.span_.innerHTML=this.get("text").toString()};function close_adv_search(){}function new_show_advanced_search(){jQuery("#search_wrapper").removeClass("hidden")}function new_hide_advanced_search(){if(mapfunctions_vars.show_adv_search==="no"){jQuery("#search_wrapper").addClass("hidden")}}function wpestate_hover_action_pin(a){for(var b=0;b<gmarkers.length;b++){if(parseInt(gmarkers[b].idul,10)===parseInt(a,10)){google.maps.event.trigger(gmarkers[b],"click");if(mapfunctions_vars.useprice!=="yes"){pin_hover_storage=gmarkers[b].icon;gmarkers[b].setIcon(custompinhover())}}}}function wpestate_return_hover_action_pin(a){for(var b=0;b<gmarkers.length;b++){if(parseInt(gmarkers[b].idul,10)===parseInt(a,10)){infoBox.close();if(mapfunctions_vars.useprice!=="yes"){gmarkers[b].setIcon(pin_hover_storage)}}}}function custompinhover(){var c,b;var d="";var a=jQuery(window).dense("devicePixelRatio");if(a>1){d="_2x"}c=mapfunctions_vars.path+"/hover"+d+".png";if(a>1){b={url:c,size:new google.maps.Size(132,144),scaledSize:new google.maps.Size(66,72),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(25,72)}}else{b={url:c,size:new google.maps.Size(90,90),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(25,72)}}return b}function map_callback(a){a(1)}var wpestate_initialize_poi=function(h,j){var d=new google.maps.places.PlacesService(h);var a="";var k="";var b=h.getBounds();var f=".google_poi";if(j==2){f=".google_poish"}jQuery(f).click(function(n){n.stopPropagation();poi_type=jQuery(this).attr("id");var l=h.getCenter();var o=i(poi_type);if(jQuery(this).hasClass("poi_active")){c(poi_type,"hide")}else{a=c(poi_type,"show");if(a===1){var m={location:l,types:o,bounds:b,radius:2500,};d.nearbySearch(m,function(q,p){g(q,p,h)})}}jQuery(this).toggleClass("poi_active")});var i=function(m){var l;switch(m){case"transport":l=["bus_station","airport","train_station","subway_station"];break;case"supermarkets":l=["grocery_or_supermarket","shopping_mall"];break;case"schools":l=["school","university"];break;case"restaurant":l=["restaurant"];break;case"pharma":l=["pharmacy"];break;case"hospitals":l=["hospital"];break}return l};var g=function(q,m,p){var l,o;if(google.maps.places.PlacesServiceStatus.OK==m){for(var n=0;n<q.length;n++){o=e(q[n],p);poi_marker_array.push(o)}}};var e=function(l,n){marker=new google.maps.Marker({map:n,position:l.geometry.location,show_poi:poi_type,icon:mapfunctions_vars.path+"/poi/"+poi_type+".png"});var m=document.createElement("div");var o=new InfoBox({content:m,boxClass:"estate_poi_box",pixelOffset:new google.maps.Size(-30,-70),zIndex:null,maxWidth:275,closeBoxMargin:"-13px 0px 0px 0px",closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),pane:"floatPane",enableEventPropagation:false});google.maps.event.addListener(marker,"mouseover",function(p){o.setContent(l.name);o.open(map,this)});google.maps.event.addListener(marker,"mouseout",function(p){if(o!==null){o.close()}});return marker};var c=function(o,m){var l=1;for(var n=0;n<poi_marker_array.length;n++){if(poi_marker_array[n].show_poi===o){if(m==="hide"){poi_marker_array[n].setVisible(false)}else{poi_marker_array[n].setVisible(true);l=0}}}return l}};function wpestate_geolocation_marker(b,e){var a=new google.maps.LatLng(b,e);map.setCenter(a);if(placeCircle!=""){placeCircle.setMap(null);placeCircle=""}marker=new google.maps.Marker({map:map,position:a,icon:mapfunctions_vars.path+"/poi/location.png"});var d;if(control_vars.geo_radius_measure==="miles"){d=parseInt(jQuery("#geolocation_radius").val(),10)*1609.34}else{d=parseInt(jQuery("#geolocation_radius").val(),10)*1000}var c={strokeColor:"#67cfd8",strokeOpacity:0.6,strokeWeight:1,fillColor:"#1CA8DD",fillOpacity:0.2,map:map,center:a,radius:parseInt(d,10)};placeCircle=new google.maps.Circle(c);map.fitBounds(placeCircle.getBounds())};